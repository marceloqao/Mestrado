\documentclass[sts]{imsart}

%\usepackage{amsthm,amsmath,natbib}
%\RequirePackage[colorlinks,citecolor=blue,urlcolor=blue]{hyperref}

% put your definitions there:
%\startlocaldefs
%\endlocaldefs

\usepackage[author-year]{amsrefs}
\usepackage{bm,bbm}
\usepackage{siunitx}

\usepackage{amssymb}
\usepackage{enumerate}
\usepackage{color}
\usepackage{siunitx}

\usepackage{subfig}
\usepackage{graphicx}
\graphicspath{{./Figures/}}

\usepackage{subfig}

\begin{document}

\begin{frontmatter}

\title{Confidence Regions for Information-Theoretic Descriptors of Time Series}
\runtitle{Confidence Regions}

\author{\fnms{Marcelo} \snm{Queiroz}\corref{}\ead[label=e1]{marceloqao@gmail.com}}
\and
\author{\fnms{Osvaldo A.} \snm{Rosso}\ead[label=e2]{oarosso@gmail.com}}
\and\\
\author{\fnms{Heitor S.} \snm{Ramos}\ead[label=e3]{heitor@laccan.ufal.br}}
\and
\author{\fnms{Christopher G.\ S.} \snm{Freitas}\ead[label=e6]{christopher@laccan.ufal.br}}
\and\\
\author{\fnms{Eduarda T.\ C.} \snm{Chagas}\ead[label=e6]{eduardachagas48@laccan.ufal.br}}
\and
\author{\fnms{Leonardo V.} \snm{Pereira}\ead[label=e4]{lviana@ic.ufal.br}}
\and\\
\author{\fnms{Alejandro C.} \snm{Frery}\ead[label=e5]{acfrery@laccan.ufal.br}}
\address{Av.\ Lourival Melo Mota, s/n\\
57072-900 Macei\'o, Brazil \printead{e1}}
\affiliation{Laborat\'orio de Computa\c c\~ao Cient\'ifica e An\'alise Num\'erica\\Universidade Federal de Alagoas}


\runauthor{M.\ Queiroz}

\begin{abstract}
The \citeauthor{PermutationEntropyBandtPompe} methodology has been used with success in time series analysis.
It consists in computing Information-Theoretic descriptors, from a histogram of ordinal patterns, which lie in a 2D manifold: the Entropy-Complexity plane.
So far, the analysis of the dynamics underlying the time series has been performed using two reference points: those corresponding to a deterministic and to white noise time series.
In this paper we provide confidence regions for white and $f^{-k}$ noise models.
These regions allow testing whether a sequence belongs to one of these models.
\end{abstract}

\begin{keyword}[class=MSC]
\kwd[Primary ]{37M10}
\kwd[; secondary ]{68Q30}
\end{keyword}

\begin{keyword}
\kwd{Nonparametric time series analysis}
\kwd{ordinal patterns}
\kwd{Information Theory}
\end{keyword}

\end{frontmatter}

\section{Introduction}\label{Sec:Intro}

Time Series carry valuable information about the system which produces the data.
Their analysis is usually based on two approaches \cite{TimeSeriesAnalysisCryerChan}: in the (natural) time and transformed domains (for instance, frequency and wavelet).

A new methodology was proposed by \citeauthor{PermutationEntropyBandtPompe}~\ycite{PermutationEntropyBandtPompe}.
Their approach is nonparametric and based on Information Theory descriptors.
The time series is transformed into ordinal patterns, with which a histogram is formed.
This approach is less sensitive to outliers, and as it does not rely on any model it can be applied to a variety of situations.

Each time series is described by a point in a manifold of $\mathbbm R^2$, namely the Entropy-Complexity plane.
Two points are well known in this plane: those of white noise and of a completely deterministic sequence.

The Band and Pompe methodology and its variants have been successfully used in the analysis of many types of dynamics.
To date, the original work has received around \num{1000} cites, according to the Journal of Citation Records.

A few highlights of the related literature are the following.
\citeauthor{RandomNumberGeneratorsCausality}~\ycite{RandomNumberGeneratorsCausality}
show that the Entropy-Complexity plane ($H\times C$) is a good indicator of the results of Diehard tests for pseudorandom number generators.
\citeauthor{GeneralizedStatisticalComplexityMeasuresGeometricalAnalyticalProperties}~\ycite{GeneralizedStatisticalComplexityMeasuresGeometricalAnalyticalProperties} analyze the logistic chaotic map and discuss the boundaries of the $H\times C$ plane.
\citeauthor{EEGAnalysisWaveletInformationTools}~\ycite{EEGAnalysisWaveletInformationTools} study electroencephalography signals using wavelet decompositions and the $H\times C$ plane.
\citeauthor{De_Micco_2008}~\ycite{De_Micco_2008} assess ways of improving pseudorandom sequences by their representation in this plane.
\citeauthor{De_Micco_2009}~\ycite{De_Micco_2009} study chaotic components in pseudorandom numbers generators.
\citeauthor{ComplexNetworksEvolution}~\ycite{ComplexNetworksEvolution} analyze the evolution of dynamic networks by trajectories in the $H\times C$ plane.
\citeauthor{DistinguishingChaoticStochasticDynamicsTimeSeriesMultiscaleSymbolicApproach}~\ycite{DistinguishingChaoticStochasticDynamicsTimeSeriesMultiscaleSymbolicApproach} use a multiscale approach to analyze the interplay between chaotic and stochastic dynamics.
\citeauthor{StructuralChangesDataCommunicationWSN}~\ycite{StructuralChangesDataCommunicationWSN} employ Information-Theoretic measures to describe the evolution of wireless sensors networks.
\citeauthor{DistinguishingNoiseFromChaos}~\ycite{DistinguishingNoiseFromChaos} tackle the often hard problem of distinguishing chaos and noise.
\citeauthor{CharacterizationVehicleBehaviorInformationTheory}~\ycite{CharacterizationVehicleBehaviorInformationTheory} describe the behavior of vehicles as a function of the topology of cities.
\citeauthor{LiborInvisibleHand}~\ycite{LiborInvisibleHand} identify spurious interventions in the Libor market using the $H\times C$ plane representation.
\citeauthor{DiagnosingDynamicsObservedSimulatedEcosystem}~\ycite{DiagnosingDynamicsObservedSimulatedEcosystem} use this tool to analyze time series from natural phenomena.
\citeauthor{InformationTheoryPerspectiveNetworkRobustness}~\ycite{InformationTheoryPerspectiveNetworkRobustness} check the effect of attacks to complex networks by the displacement of their points in the $H\times C$ plane.
\citeauthor{ClassificationVerificationOnlineHandwrittenSignatures}~\ycite{ClassificationVerificationOnlineHandwrittenSignatures} show that these descriptors are able to classify and verify online signatures.
\citeauthor{CharacterizationElectricLoadInformationTheoryQuantifiers}~\ycite{CharacterizationElectricLoadInformationTheoryQuantifiers}
show that Information-Theoretic descriptors are able to characterize types of electric appliances by records of their energy consumption.

In spite of these and many other applications, only recently \cites{OrdinalPatternProbabilities,NewPermutationEntropy} the literature has started paying attention to the inherent randomness of points in the $H\times C$ plane.
The knowledge of the expected variability of such points according to the underlying dynamics would allow making hypotheses tests to a variety of models.

This paper advances the state-of-the-art by providing confidence regions for points in the $H\times C$ plane for a diversity of situations of interest.
Such regions are obtained using a Monte Carlo approach.
The input is a sequence of actual random observations generated by a physical procedure.

Section~\ref{Sec:Intro} introduces the elements of the study (the Bandt and Pompe methodology, the random deviates and models).
The confidence regions are presented in Section~\ref{Sec:Results}, and the conclusions are discussed in Section~\ref{Sec:Conclusions}.


\section{Methodology}\label{Sec:Method}

\subsection{The Bandt and Pompe Methodology}

Let ${\mathcal X} \equiv \{x_t\}_{t=1}^{T}$ be a real valued time series of length $T$, without ties. 
As stated by \citeauthor{PermutationEntropyBandtPompe}~\ycite{PermutationEntropyBandtPompe} in their seminal work:  
\begin{quote}
``If the $\{x_t\}_{t=1}^{T}$ attain infinitely many values, it is common to replace them by a symbol sequence 
$\Pi \equiv \{\pi_j\}$ with finitely many symbols, and calculate source entropy from it".
\end{quote}
Also, as stressed by these authors, 
\begin{quote}
``The corresponding symbol sequence must come 
naturally from the $\{x_t\}_{t=1}^{T}$ without former model assumptions".
\end{quote}

Let ${\mathfrak A}_{D}$ (with $D \geq 2$ and $D \in {\Bbb Z}$) be the symmetric group of order $D!$ formed by all 
possible permutation of order $D$, and the symbol component vector 
${\bm \pi}^{(D)} = (\pi_1, \pi_2, \dots, \pi_D)$ so every element ${\bm \pi}^{(D)}$ is unique 
($\pi_j \neq \pi_k~\forall~j \neq k$). 
Consider for the time series ${\mathcal X} \equiv \{x_t\}_{t=1}^{T}$ its time delay embedding representation,
with embedding dimension $D \geq 2$ ($D \in {\Bbb Z}$) and time delay $\tau \geq 1$ ($\tau \in {\Bbb Z}$, also called ``embedding time''):
\begin{equation} 
\label{eq:time-delay}
{\mathbf X}^{(D,\tau)}_t ~=~( x_t,x_{t+\tau},\dots,x_{t+(D-1)\tau} ) \ ,
\end{equation} 
for $t = 1,2,\dots,N$ with $N = T-(D-1) \tau$.
Then the vector ${\mathbf X}^{(D,\tau)}_t$ can be mapped to a symbol vector ${\bm \pi}^{(D)} \in {\mathfrak A}_{D}$. 
This mapping should be defined in a way that preserves the desired relation between the elements 
$x_t  \in {\mathbf X}^{(D,\tau)}_t$, and all $t \in T$ that share this pattern (also called motif) have to mapped to the same 
${\bm \pi}^{(D)}$. 
The two most frequent ways to define the mapping ${\mathbf X}^{(D,\tau)} \mapsto {\bm \pi}^{(D)}$ are:  
\begin{enumerate}[a)]
\item ordering the ranks of the $x_t \in {\mathbf X}^{(D,\tau)}$ in chronological order 
       (\textit{Rank Permutation}) or,
\item ordering the time indexes according to the ranks of $x_t \in {\mathbf X}^{(D,\tau)}$  
       (\textit{Chronological Index Permutation});
\end{enumerate}
       see details in \citeauthor{BPRepeatedValuesChaos}~\ycite{BPRepeatedValuesChaos}.
Without loss of generality, in the following we will only use the latter.

Consider, for instance, the time series $\mathcal X = (1.8, 1.2, 3.2, 4.8, 4.2, 4.5, 2.3, 3.7, 1.2, .5)$ depicted in Fig.~\ref{Fig:IntroBP}.
Assume we are using patterns of length $D=5$ with unitary time lag $\tau=1$.
The code associated to $\mathbf X_{3}^{(5,1)}=(x_3,\dots,x_7)=(3.2, 4.8, 4.2, 4.5, 2.3)$, shown in black, is formed by the indexes in $\bm\pi^{(5)}=(1,2,3,4,5)$ which sort the elements of $\mathbf X_{3}^{(5,1)}$ in increasing order: $51342$.
With this, $\widetilde{\pi}^{(5)} = 51342$, and we increase the counting related to this motif in the histogram of all possible patterns of size $D=5$.

The dash-dot line in Fig.~\ref{Fig:IntroBP} illustrates $\mathbf X_{1}^{(5,2)}$, i.e. the sequence of length $D=5$ starting at $x_1$ with lag $\tau=2$.
In this case, $\mathbf X_{1}^{(5,2)}= (1.8, 3.2, 4.2, 2.3, 1.2)$, and the corresponding motif is $\widetilde{\pi}^{(5)}=51423$.

\begin{figure}[hbt]
\centering
\includegraphics[width=.7\linewidth]{IntroBP}
\caption{Illustration of the Bandt and Pompe coding\label{Fig:IntroBP}}
\end{figure}

Once all symbols have been computed, one obtains the histogram of proportions $\bm h = (h(j))_{1\leq j\leq D!}$.
This is an estimate of the (unknown, in general) probability distribution function of these patterns.
The next step into the characterization of the time series is computing descriptors from this histogram.

The first descriptor is a measure of the disorder of the system.
The most frequently used feature for this is the Normalized Shannon entropy, defined as
\begin{equation}
H(\bm h) = -\frac{1}{\log D!} \sum_{j=1}^{D!} h(j) \log h(j),
\end{equation}
with the convention that terms in the summation for which $h(j)=0$ are null.
This quantity is bounded in the unit interval, and is zero when $h(j)=1$ for some $j$ (and, thus, all other bins are zero), and one when $h(j)=1/D!$ for every $j$ (the uniform probability distribution function).

Although very expressive, the Normalized Shannon Entropy is not able to describe all possible underlying dynamics.
In particular, for intermediate values of $H$, there is a wide variety of situations worth characterizing.
To this aim, \citeauthor{LopezRuiz1995}~\ycite{LopezRuiz1995} proposed using $Q$, the disequilibrium, a measure of how far $\bm h$ is from an equilibrium or noninformative distribution.
They employed the Euclidean distance between $\bm h$ and the uniform probability distribution function.

With this, they proposed $C=HQ$ as a measure of the Statistical Complexity of the underlying dynamics.
A time series can then be mapped into a point in the $H\times C$ plane.


\subsection{The Entropy-Complexity Plane}

We illustrate the use of the Entropy-Complexity ($H\times C$) with the following time series:
\begin{itemize}
\item Colored $k$-noise: white ($k=0$), $k=-1/2$, pink ($k=1$), $k=3/2$, red ($k=2$), $=5/2$, and $k=3$;
\item Chaotic logistic series $x_t = r x_{t-1} (1 - x_{t-1})$, with $r=3.6$ and $4$;
\item Deterministic series: monotonic increasing ($\log(x_t+0.1)$, $x_t=\{1,2,\dots,10^4$) and periodic ($\sin(2x_t)\cos(2x_t)$, with $0\leq x_t\leq 2\pi$ over ten thousand equally spaced points).
\end{itemize}
In all cases, we used $D=6$ and $\tau=1$.
Fig.~\ref{fig:Histograms} shows nine of the histograms produced by these series;
we omitted those corresponding to the deterministic series, as they produce one and two nonzero bins.

\begin{figure}[hbt]
\centering
	\subfloat[Logistic map $r=3.6$]{\includegraphics[width=.23\linewidth]{h36}}\quad
	\subfloat[Logistic map $r=4$]{\includegraphics[width=.23\linewidth]{h4}}\quad
	\subfloat[$f^{-3}$ noise]{\includegraphics[width=.23\linewidth]{h3}}\quad
	\subfloat[$f^{-5/2}$ noise]{\includegraphics[width=.23\linewidth]{h25}}\quad
	\subfloat[$f^{-2}$ noise]{\includegraphics[width=.23\linewidth]{h2}}\quad
	\subfloat[$f^{-1.5}$ noise]{\includegraphics[width=.23\linewidth]{h15}}\quad
	\subfloat[$f^{-1}$ noise]{\includegraphics[width=.23\linewidth]{h1}}\quad
	\subfloat[$f^{-1/2}$ noise]{\includegraphics[width=.23\linewidth]{h05}}\quad
	\subfloat[White noise]{\includegraphics[width=.23\linewidth]{h0}}
	\caption{Patterns histograms of selected time series, with $D=6$ and $\tau=1$\label{fig:Histograms}}
\end{figure}


Fig.~\ref{fig:AllSystems} shows the $H\times C$ plane with the bounds for $D=6$, the time series and the points they were mapped onto.
The points due to $f^{-k}$ noises appear joined by dotted segments.
It is noticeable that deterministic patterns have more complexity than random ones.
Also, points related to $f^{-k}$ noises tend to clutter for $k<1$.

\begin{figure}[hbt]
\centering
\includegraphics[width=\linewidth]{AllSystems}
\caption{Eleven systems and their points in the $H\times C$ plane}\label{fig:AllSystems}
\end{figure}

Fig.~\ref{fig:RightMostCorner} shows the rightmost lower corner of the $H\times C$ plane, emphasizing the location of the white ($k=0$), $k=-1/2$, and pink ($k=1$) noises.

\begin{figure}[hbt]
\centering
\includegraphics[width=\linewidth]{RightMostCorner}
\caption{White Noise, $f^{-1/2}$ and $f^{-1}$ noise points}\label{fig:RightMostCorner}
\end{figure}

The focus of our study is the empirical distribution of points produced by White and selected $f^{-k}$ noises, with this, providing confidence regions in the $H\times C$ plane.
In particular, we are interested in assessing pure randomness with this technique.

\subsection{Random Deviates and Models}

\textcolor{red}{Gerador - Marcelo}

Random numbers are used in many fields, from gambling to criptography, aiming to guarantee a secure, realistic or unpredictable behavihor. Pseudo randomic results can be achieved by software in a deterministic way. But, some applications needs a real random numbers. Therefore, that real random behavior are hard to reach and some unpredictable real world phenomenon like cathodic radiation or the atmospheric noise, in this study we used two sources of real random numbers. The first one is based on vacuum states to generate random quantum numbers described on (https://doi.org/10.1038/nphoton.2010.197), the second one is based on atmospheric noise captured by a cheap radio receiver at www.random.org as described  here (https://www.random.org/history)

%Deixei as URLs pois não tenho o .bib ...

%The colored $k$-noise mentioned in the previous section, also known as ``correlated noise'', is such that its power spectrum has shape $f^{-k}$.
%When $k=0$, we have white noise, i.e., independent deviates.
%The larger $k$ is, the more correlated the observations are.


\section{Results}\label{Sec:Results}

We employed the following factors in this study:
\begin{itemize}
\item Time series length $T\in\mathcal T=\{10^3,10^4, \num[scientific-notation=true]{5 e4}, \num[scientific-notation=true]{e5}, \num[scientific-notation=true]{5 e5}\}$,
\item Embedding dimension $D\in\mathcal D=\{3, 4, 5, 6\}$, and
\item Exponent of the $f^{-k}$ noise $k\in\mathcal K=\{0, 0.1, 0.5, 1, 1.5, 2\}$.
\end{itemize}
The only time delay we report is $\tau=1$.
We repeated the experiments for time lags $\tau=\{10,30,50\}$, and no significant differences were observed.
We obtained $1000$ independent series for each point in the factors set $\mathcal T\times \mathcal D\times \mathcal K$.

\textcolor{red}{An\'alise descritiva: alguns pontos de $\Theta$ representativos:} 
% k=0 white
% k=1 pink
% k=2 brown
% T = 1000, T = 5 10^5
% D= 3, D = 6

\textcolor{red}{Justificar o tipo de an\'alise: regressão? bivariada clássica? não-paramétrica?}

\textcolor{red}{Intervalos de confian\c ca}

The data generation and analyses were performed using the \texttt R platform \cite{Rmanual} v.~3.4.4.
We used the \texttt{ggplot2} library \cite{ggplot2Wickman} for generating the plots.

\section{Conclusions}\label{Sec:Conclusions}

\bibliography{../Texto/references}

\end{document}
